@model Coontrera.Models.DTOs.UsuarioDTO
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Crie sua Conta";
}

@section Styles {
    <style>
        body {
            background-color: #f6eefb;
        }
        .container-box {
            max-width: 600px;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(122, 79, 155, 0.12);
            margin-top: 30px;
            margin-bottom: 30px;
        }
        .container-box .logo-container {
            text-align: center;
            margin-bottom: 25px;
        }
        .container-box .logo-container img {
            max-height: 70px;
        }
        .container-box h2.form-title {
            font-family: var(--font-primary);
            font-weight: 600;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        .container-box p.form-subtitle {
            text-align: center;
            color: var(--text-light);
            margin-bottom: 30px;
            font-size: 0.95rem;
        }
        .form-check-label {
            color: #5e315b;
        }
        .tooltip-inner {
            max-width: 300px;
            text-align: justify;
            background-color: #d1a3ff;
            color: white;
            border-radius: 5px;
            padding: 10px;
        }
        .modal-content-custom {
            background-color: #f6eefb;
            color: #5e315b;
            text-align: center;
            border-radius: 10px;
        }
        .form-label {
            color: var(--text-dark);
            font-weight: 500;
            margin-bottom: 0.3rem;
        }
        .form-control, .form-select {
            border-radius: 8px;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border: 1px solid var(--light-gray);
        }
        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.25rem rgba(var(--bs-primary-rgb), 0.15);
        }
    </style>
}

<div class="container d-flex justify-content-center align-items-center min-vh-100 py-4">
    <div class="container-box w-100" data-aos="fade-up">
        <div class="logo-container">
            <a asp-controller="Home" asp-action="Index">
                <img src="~/images/logo.svg" alt="Coontrera Logo">
            </a>
        </div>
        <h2 class="form-title">@ViewData["Title"]</h2>
        <p class="form-subtitle">Preencha os campos abaixo para se cadastrar.</p>

        <div asp-validation-summary="ModelOnly" class="alert alert-danger d-flex align-items-center" role="alert">
             <i class="fas fa-exclamation-triangle me-2"></i>
             <div></div>
        </div>

        @if (!ViewData.ModelState.IsValid && ViewData.ModelState[""] != null)
        {
            foreach (var error in ViewData.ModelState[""].Errors)
            {
                <div class="alert alert-danger alert-dismissible fade show d-flex align-items-center" role="alert">
                    <i class="fas fa-times-circle me-2"></i>
                    <div>@error.ErrorMessage</div>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }
        }

        <form asp-controller="Cadastro" asp-action="Cadastro" method="post">
            <div class="mb-3">
                <label asp-for="Nome" class="form-label">Nome Completo</label>
                <input asp-for="Nome" class="form-control" placeholder="Digite seu nome completo">
                <span asp-validation-for="Nome" class="text-danger small mt-1"></span>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label asp-for="Telefone" class="form-label">Telefone</label>
                    <input asp-for="Telefone" type="tel" class="form-control" placeholder="Ex: 16999998888">
                    <span asp-validation-for="Telefone" class="text-danger small mt-1"></span>
                </div>
                <div class="col-md-6 mb-3">
                    <label asp-for="Email" class="form-label">Email</label>
                    <input asp-for="Email" type="email" class="form-control" placeholder="seuemail@exemplo.com">
                    <span asp-validation-for="Email" class="text-danger small mt-1"></span>
                </div>
            </div>

            <div class="mb-3">
                <label asp-for="Senha" class="form-label">Senha</label>
                <input asp-for="Senha" type="password" class="form-control" placeholder="Crie uma senha forte">
                <span asp-validation-for="Senha" class="text-danger small mt-1"></span>
            </div>

            <div class="mb-4 form-check">
                <input type="checkbox" class="form-check-input" id="termos" name="termos" value="true" required>
                <label class="form-check-label" for="termos" data-bs-toggle="tooltip" data-bs-placement="top"
                       title="Ao aceitar estes Termos de Uso, vocÃª concorda e autoriza expressamente que a clÃ­nica, na qualidade de controladora dos dados, utilize suas informaÃ§Ãµes pessoais, incluindo o nÃºmero de telefone fornecido no cadastro, para fins de contato e prestaÃ§Ã£o de serviÃ§os, conforme previsto em nossa PolÃ­tica de Privacidade. Ressaltamos que seus dados serÃ£o tratados com seguranÃ§a e confidencialidade, em conformidade com a Lei nÂº 13.709/2018 (LGPD). VocÃª pode, a qualquer momento, revogar esta autorizaÃ§Ã£o ou solicitar mais informaÃ§Ãµes sobre o tratamento dos seus dados atravÃ©s dos canais de atendimento disponibilizados.">
                    Li e aceito os <a href="/termos-de-uso" target="_blank" style="color: var(--primary-color);">Termos de Uso</a> e <a href="/politica-de-privacidade" target="_blank" style="color: var(--primary-color);">PolÃ­tica de Privacidade</a>.
                </label>
                 <div class="invalid-feedback">VocÃª deve aceitar os termos e condiÃ§Ãµes.</div>
            </div>

            <button type="submit" class="btn btn-primary w-100 py-2 fw-bold">Cadastrar e Ganhar Aula Experimental</button>
        </form>

        <div class="text-center mt-4">
            <p class="text-muted small">JÃ¡ tem uma conta? <a asp-controller="Conta" asp-action="Login" style="color: var(--primary-color); font-weight: 500;">FaÃ§a Login</a></p>
        </div>
    </div>
</div>

@if (TempData["CadastroSucesso"] != null)
{
<div class="modal fade" id="popupMensagemCadastro" tabindex="-1" aria-labelledby="popupLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-content-custom p-4">
            <div class="modal-header border-0">
                 <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div style="font-size: 3rem; color: var(--primary-color); margin-bottom:15px;"><i class="fas fa-party-horn"></i></div>
                <h4 style="color: var(--primary-color); font-weight:600;">ParabÃ©ns!</h4>
                <p>Seu cadastro foi realizado com sucesso!</p>
                <p>Ao realizar o cadastro, vocÃª acaba de ganhar uma aula experimental gratuita! <i class="fas fa-gift"></i></p>
                <p>Nossa equipe entrarÃ¡ em contato com vocÃª em breve para confirmar os detalhes. <i class="fas fa-hourglass-half"></i></p>
                <p>Agradecemos pela sua confianÃ§a e estamos ansiosos para te receber! ðŸ˜Š</p>
            </div>
            <div class="modal-footer border-0 justify-content-center">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Entendido!</button>
            </div>
        </div>
    </div>
</div>
}

@section Scripts {
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial"); }
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var termosLabel = document.querySelector('.form-check-label[for="termos"]');
            if (termosLabel) {
                new bootstrap.Tooltip(termosLabel);
            }

            var modalElement = document.getElementById('popupMensagemCadastro');
            if (modalElement) {
                var myModal = new bootstrap.Modal(modalElement);
                myModal.show();
                @if (TempData["CadastroSucesso"] != null) {
                    TempData.Remove("CadastroSucesso");
                }
            }
        });

        (function () {
            'use strict'
            var forms = document.querySelectorAll('form')
            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }
                        form.classList.add('was-validated')
                    }, false)
                })
        })()
    </script>
}