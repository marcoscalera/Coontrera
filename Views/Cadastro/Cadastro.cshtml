@model Coontrera.Models.DTOs.UsuarioDTO
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Cadastro";
}

@section Styles {
    <style>
        body {
            background-color: #f6eefb; /* */
            font-family: 'Afacad', sans-serif; /* */
            /* overflow: hidden; Removido para permitir scroll se necess√°rio */
        }

        .container-box {
            max-width: 600px; /* */
            background: white; /* */
            padding: 40px; /* */
            border-radius: 10px; /* */
            box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.15); 
            margin-top: 30px;
            margin-bottom: 30px;
        }

        .form-check-label {
            color: #5e315b; /* */
        }

        .tooltip-inner {
            max-width: 300px; /* */
            text-align: justify; /* */
            background-color: #d1a3ff; /* */
            color: white; /* */
            border-radius: 5px; /* */
            padding: 10px; /* */
        }

        .modal-content-custom { /* Renomeado para evitar conflito com modal padr√£o */
            background-color: #f6eefb; /* */
            color: #5e315b; /* */
            text-align: center; /* */
            border-radius: 10px;
        }
        .form-label {
            color: #5e315b;
            font-weight: 500;
        }
    </style>
}

<div class="container d-flex justify-content-center align-items-center min-vh-100">
    <div class="container-box w-100">
        <div class="text-center mb-4">
            <img src="~/images/logo.svg" alt="Logo Coontrera" style="max-height: 80px;"/>
            <h2 class="mt-2" style="color: #5e315b;">Crie sua Conta</h2>
            <p class="text-muted">Preencha os campos abaixo para se cadastrar.</p>
        </div>

        <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>
        
        @if (!ViewData.ModelState.IsValid && ViewData.ModelState[""] != null)
        {
            @foreach (var error in ViewData.ModelState[""].Errors)
            {
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    @error.ErrorMessage
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            }
        }


        <form asp-controller="Cadastro" asp-action="Cadastro" method="post">
            <div class="mb-3">
                <label asp-for="Nome" class="form-label">Nome Completo:</label>
                <input asp-for="Nome" class="form-control" placeholder="Digite seu nome completo">
                <span asp-validation-for="Nome" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Telefone" class="form-label">Telefone (somente n√∫meros):</label>
                <input asp-for="Telefone" type="tel" class="form-control" placeholder="Ex: 16999998888">
                <span asp-validation-for="Telefone" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Email" class="form-label">Email:</label>
                <input asp-for="Email" type="email" class="form-control" placeholder="seuemail@exemplo.com">
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <label asp-for="Senha" class="form-label">Senha:</label>
                <input asp-for="Senha" type="password" class="form-control" placeholder="Crie uma senha forte">
                <span asp-validation-for="Senha" class="text-danger"></span>
            </div>
            
            @* <div class="mb-3">
                <label class="form-label">Confirmar Senha:</label>
                <input type="password" class="form-control" name="ConfirmarSenha" placeholder="Confirme sua senha">
                </div> *@


            <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="termos" name="termos" value="true" required>
                <label class="form-check-label" for="termos" data-bs-toggle="tooltip" data-bs-placement="top"
                       title="Ao aceitar estes Termos de Uso, voc√™ concorda e autoriza expressamente que a cl√≠nica... (LGPD).">
                    Li e aceito os Termos de Uso e Pol√≠tica de Privacidade.
                </label>
                 <div class="invalid-feedback">Voc√™ deve aceitar os termos e condi√ß√µes.</div> </div>

            <button type="submit" class="btn btn-primary w-100 py-2">Cadastrar e Ganhar Aula Experimental</button>
        </form>

        <div class="text-center mt-4">
            <p class="text-muted">J√° tem uma conta? <a asp-controller="Conta" asp-action="Login" class="text-link" style="color: #5e315b;">Fa√ßa Login</a></p>
        </div>
    </div>
</div>

@if (TempData["CadastroSucesso"] != null)
{
<div class="modal fade" id="popupMensagemCadastro" tabindex="-1" aria-labelledby="popupLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-content-custom p-4">
            <div class="modal-header border-0">
                 <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h4>üéâ Parab√©ns!</h4>
                <p>Seu cadastro foi realizado com sucesso!</p>
                <p>Ao realizar o cadastro, voc√™ acaba de ganhar uma aula experimental gratuita! üéÅ</p>
                <p>Nossa equipe entrar√° em contato com voc√™ em breve para confirmar os detalhes. ‚è≥</p>
                <p>Agradecemos pela sua confian√ßa e estamos ansiosos para te receber! üòä</p>
            </div>
            <div class="modal-footer border-0 justify-content-center">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Entendido!</button>
            </div>
        </div>
    </div>
</div>
}


@section Scripts {
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial"); }
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Tooltip para termos de uso
            var termosLabel = document.querySelector('.form-check-label[for="termos"]');
            if (termosLabel) {
                new bootstrap.Tooltip(termosLabel);
            }

            // Mostrar modal de sucesso se TempData estiver presente
            var modalElement = document.getElementById('popupMensagemCadastro');
            if (modalElement) {
                var myModal = new bootstrap.Modal(modalElement);
                myModal.show();
         
                @if (TempData["CadastroSucesso"] != null) {
                    TempData.Remove("CadastroSucesso");
                }
            }
        });

        // para for√ßar a valida√ß√£o do checkbox "required" do HTML5
        (function () {
            'use strict'
            var forms = document.querySelectorAll('form')
            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }
                        form.classList.add('was-validated')
                    }, false)
                })
        })()
    </script>
}